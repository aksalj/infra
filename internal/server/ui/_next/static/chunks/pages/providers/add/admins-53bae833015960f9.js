(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[501],{1071:function(n,e,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/providers/add/admins",function(){return r(1150)}])},1150:function(n,e,r){"use strict";r.r(e),r.d(e,{default:function(){return O}});var t=r(4051),a=r.n(t),i=r(5893),o=r(7294),c=r(9669),u=r.n(c),s=r(1163),d=r(4862),f=r(7054),l=r(3206),p=r(1664),h=r(2125),v=r(983),x=r(292),m=r(7161);function w(n,e){return e||(e=n.slice(0)),Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(e)}}))}function g(){var n=w(["\n  font-weight: 100;\n  font-size: 11px;\n  line-height: 13px;\n  max-width: 24rem;\n\n  span {\n    opacity: .5;\n  }\n\n  a {\n    padding-left: .5rem;\n    color: #93DEFF;\n    text-decoration: none;\n\n    :hover {\n      opacity: .95;\n      text-decoration: underline;\n    }\n  }\n"]);return g=function(){return n},n}function k(){var n=w(["\n  font-weight: 100;\n  font-size: 11px;\n  line-height: 13px;\n  max-width: 24rem;\n\n  text-align: center;\n\n  a {\n    padding-left: .5rem;\n    color: #93DEFF;\n    text-decoration: none;\n    cursor: pointer;\n\n    :hover {\n      opacity: .95;\n      text-decoration: underline;\n    }\n  }\n"]);return k=function(){return n},n}var j=h.ZP.div.withConfig({componentId:"sc-ded88333-0"})(g()),b=h.ZP.div.withConfig({componentId:"sc-ded88333-1"})(k()),_=function(n){var e=n.email,r=n.parentCallback;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(m.Z,{}),(0,i.jsx)(x.Z,{header:"Set up an infra admin",subheader:(0,i.jsxs)(j,{children:[(0,i.jsx)("span",{children:"Great work. Now provide an email of your Okta users that you would like to make an Infra admistrator."}),(0,i.jsx)("a",{target:"_blank",rel:"noreferrer",href:"https://github.com/infrahq/infra/blob/main/docs/providers/okta.md",children:"Make sure to assign them in Okta."})]})}),(0,i.jsx)("div",{children:(0,i.jsx)(v.Z,{label:"Admin Email",value:e,onChange:function(n){return r(n.target.value)}})}),(0,i.jsx)(p.default,{href:"/",children:(0,i.jsx)(b,{children:(0,i.jsx)("a",{children:"Or set up an Infra admin later."})})})]})},C=r(6843);function y(n,e,r,t,a,i,o){try{var c=n[i](o),u=c.value}catch(s){return void r(s)}c.done?e(u):Promise.resolve(u).then(t,a)}function P(n){return function(){var e=this,r=arguments;return new Promise((function(t,a){var i=n.apply(e,r);function o(n){y(i,t,a,o,c,"next",n)}function c(n){y(i,t,a,o,c,"throw",n)}o(void 0)}))}}var E=function(){var n=P(a().mark((function n(e){return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,u().post("/v1/grants",{identity:e,resource:"infra",privilege:"admin"}).then(P(a().mark((function n(){return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,s.default.push({pathname:"/providers"},void 0,{shallow:!0});case 2:case"end":return n.stop()}}),n)})))).catch((function(n){console.log(n)}));case 2:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),O=function(){var n=(0,o.useContext)(C.Z).newestProvider,e=(0,o.useState)(""),r=e[0],t=e[1],c=(0,o.useCallback)((function(n){t(n)})),s=function(){var e=P(a().mark((function e(){var t,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n&&n.id,i={email:r,provider_id:t},e.next=4,u().get("/v1/users",{params:i}).then(function(){var n=P(a().mark((function n(e){return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(0!==e.data.length){n.next=5;break}return n.next=3,u().post("/v1/users",{email:r,providerID:t}).then(function(){var n=P(a().mark((function n(e){return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,E(e.data.id);case 2:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()).catch((function(n){console.log(n)}));case 3:n.next=6;break;case 5:E(e.data[0].id);case 6:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()).catch((function(n){console.log(n)}));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(d.AddContainer,{children:[(0,i.jsx)(d.AddContainerContent,{children:(0,i.jsx)(_,{email:r,parentCallback:c})}),(0,i.jsx)(d.Nav,{children:(0,i.jsx)(f.Z,{previousPage:"/providers"})})]}),(0,i.jsx)(d.Footer,{children:(0,i.jsx)(l.Z,{onClick:function(){return s()},value:"Proceed",size:"small"})})]})}}},function(n){n.O(0,[125,904,862,774,888,179],(function(){return e=1071,n(n.s=e);var e}));var e=n.O();_N_E=e}]);